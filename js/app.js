// Generated by CoffeeScript 1.6.2
var __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

$(function() {
  var BUZZ, IS_IN, IS_NOT_IN, MAP, MY_AREA, MY_IMAGE, MY_LOCATION, MY_TEXT, MY_TIME, MY_WEATHER, SIREN, TIME, WEATHER, YOUTUBE, block_camera, block_ding, block_ids, block_image_recognition, block_map, block_my_location, block_my_time, block_my_weather, block_siren, block_text, block_time, block_weather, control_if_then, operator_equals, run,
    _this = this;

  window.global_block_width = window.global_block_height = 290;
  block_ding = new block_ding_();
  block_siren = new block_siren_();
  block_camera = new block_camera_();
  block_time = new block_time_();
  block_image_recognition = new block_image_recognition_();
  block_map = new block_map_();
  block_my_time = new block_my_time_();
  block_my_location = new block_my_location_();
  block_my_weather = new block_my_weather_();
  block_text = new block_text_();
  block_weather = new block_weather_();
  operator_equals = new operator_equals_();
  control_if_then = new control_if_then_();
  /*
  	triggers is a JS object broken up like the following:
  	first: the first condition given
  	operator: the type of operator
  	second: second condition given
  	action: thing to do next
  */

  IS_IN = 6;
  IS_NOT_IN = 7;
  MY_AREA = 0;
  MY_LOCATION = 1;
  WEATHER = 2;
  run = function(triggers, action) {
    var first_block, my_weather, operator, second_block, tags, text, weather;

    first_block = triggers.first_block;
    operator = triggers.operator;
    second_block = triggers.second_block;
    if ((first_block === MY_TIME && second_block === TIME) || (first_block === TIME && second_block === MY_TIME)) {
      if (block_time.run() === block_my_time.run()) {
        return action();
      }
    } else if ((first_block === MY_IMAGE && second_block === MY_TEXT) || (first_block === MY_TEXT && second_block === MY_IMAGE)) {
      tags = block_image_recognition.run();
      text = block_my_text.run();
      if (__indexOf.call(tags, text) >= 0) {
        return action();
      }
    } else if ((first_block === MY_WEATHER && second_block === WEATHER) || (first_block === WEATHER && second_block === MY_WEATHER)) {
      weather = block_weather.run();
      my_weather = block_my_weather.run();
      if (weather === my_weather) {
        return action();
      }
    } else if ((first_block === MY_LOCATION && second_block === MY_AREA) || (first_block === MY_AREA && second_block === MY_LOCATION)) {
      return block_map.run(action);
    }
  };
  MAP = 3;
  BUZZ = 4;
  SIREN = 10;
  TIME = 8;
  MY_TIME = 9;
  MY_IMAGE = 100;
  MY_TEXT = 150;
  MY_WEATHER = 12;
  YOUTUBE = 120;
  block_ids = {
    drag1: MY_LOCATION,
    drag2: WEATHER,
    drag3: IS_IN,
    drag4: BUZZ,
    drag5: MY_AREA,
    drag6: SIREN,
    drag7: TIME,
    drag8: MY_TIME,
    drag9: YOUTUBE,
    drag10: MY_IMAGE,
    drag11: MY_TEXT,
    drag15: MY_WEATHER
  };
  $("#reset").click(function() {
    return location.reload();
  });
  return $("#run").click(function() {
    var action, cur_id, element, elements_in_environment, first_block_accounted_for, triggers, _i, _len;

    triggers = {};
    action = null;
    elements_in_environment = $(".drop_over.draggable");
    first_block_accounted_for = false;
    for (_i = 0, _len = elements_in_environment.length; _i < _len; _i++) {
      element = elements_in_environment[_i];
      cur_id = element.id;
      if (cur_id === "drag3") {
        triggers.operator = block_ids[cur_id];
      } else if (cur_id === "drag4") {
        action = block_ding.run;
      } else if (cur_id === "drag6") {
        action = block_siren.run;
      } else if (cur_id === "drag13") {
        action = block_camera.run;
      } else if (cur_id === "drag9") {
        action = block_youtube.run;
      } else {
        if (first_block_accounted_for === !true) {
          first_block_accounted_for = true;
          triggers.first_block = block_ids[cur_id];
        } else {
          console.log("hello");
          console.log("cur_id " + cur_id);
          triggers.second_block = block_ids[cur_id];
        }
      }
    }
    return run(triggers, action);
  });
});
